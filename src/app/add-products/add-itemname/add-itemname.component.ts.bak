import { Component, OnInit } from '@angular/core';
import { FormGroup, FormControl, Validators } from '@angular/forms';
import { HttpClient } from '@angular/common/http';
import { FormValidators} from '../login/login-form.validators';
import { forkJoin } from 'rxjs';
import { ActivatedRoute, Router } from '@angular/router';
import {TestitemService} from '../services/testitem.service';
import { AppError } from '../common/app-error';

@Component({
  selector: 'app-add-itemname',
  templateUrl: './add-itemname.component.html',
  styleUrls: ['./add-itemname.component.scss']
})
export class AddItemnameComponent implements OnInit {

  itemnameData: any;
  form = new FormGroup({
    newitemname: new FormGroup({
      name:  new FormControl,
      tax:   new FormControl,
      insurance:  new FormControl
    })
  });
  constructor(private testitem: TestitemService,
    private router: Router) { }

  ngOnInit() {

 }

  get name () {
    return this.form.get('newitemname.name');
  }


  additemname() {
    const formData = {
      name:   this.form.value.newitemname.name,
      tax:  this.form.value.newitemname.tax,
      insurance:   this.form.value.newitemname.insurance
    };

    this.testitem.create(formData)
    .subscribe(response => {
      this.itemnameData = response;;
      alert('Registration successful, Please login');
      // this.router.navigate(['/login']);
    }, (error: AppError) => {
      console.log(error);
      if (error.originalError.status === 400) {
        alert('Invalid id or password');
      } else {
        this.router.navigate(['/errorpage']);
      }
      console.log(error.originalError.status);
    });
  }
 }
